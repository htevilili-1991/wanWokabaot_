import{u as pe,r as o,a as T,b as j,j as e,H as je,L as fe}from"./app-DH8btaUO.js";import{C as B}from"./checkbox-Dc8O_WKc.js";import{H as ve}from"./heading-DeTa0XcH.js";import{g as k,A as be,h as U,j as ye,u as Ce,k as z}from"./app-layout-BwMuRh4w.js";import{B as u}from"./app-logo-icon-Cp3mBhT3.js";import{C as R,d as G,a as ke,b as Ne,c as Se}from"./card-CWtfQ6EU.js";import{e as I,f as E,d as q,b as O,D as A,a as $,c as H}from"./dialog-DhDMvRxP.js";import{I as l}from"./input-BzFALaBE.js";import{L as n}from"./label-BhiLzNVm.js";import{S as _e,a as De,b as we,c as Pe,d as w,C as y,e as C}from"./select-_E2f0L1T.js";import{e as Fe,c as Te,T as J,b as x,d as Ie,a as h}from"./table-DislBiDq.js";import{D as Ee}from"./delete-confirmation-popover-DuHGNm1w.js";import{T as qe}from"./trash-2-Bl_KDGSt.js";import{S as Oe}from"./search-Du1Pg1ZC.js";/* empty css            */import"./index-D7pXJOK0.js";import"./index-DbeBujGd.js";import"./check-MSR6y9Ih.js";import"./index-BqCeLl6e.js";import"./triangle-alert-DCvwbpYG.js";const Ae=[{title:"Inventory",href:k().url}];function is({products:c,filters:N}){const{flash:$e}=pe().props,[S,K]=o.useState(N.search||""),[d,Q]=o.useState(N.sort_by||"created_at"),[m,W]=o.useState(N.sort_direction||"desc"),[v,X]=o.useState(N.per_page||10),[Y,M]=o.useState(!1),[He,P]=o.useState(!1),[Z,g]=o.useState(!1),[F,_]=o.useState(null),[ee,V]=o.useState(!1),[p,D]=o.useState([]),se=o.useMemo(()=>c.data.length>0&&p.length===c.data.length,[c.data,p]),te=s=>{D(s?c.data.map(i=>i.id):[])},re=(s,i)=>{D(r=>i?[...r,s]:r.filter(ge=>ge!==s))},a=T({name:"",category:"",cost_price:"",selling_price:"",current_stock:"",minimum_stock:"",description:""}),t=T({id:"",name:"",category:"",cost_price:"",selling_price:"",current_stock:"",minimum_stock:"",description:""}),f=T({file:null}),ae=o.useMemo(()=>{let s;return i=>{clearTimeout(s),s=setTimeout(()=>{j.get(k().url,{search:i,sort_by:d,sort_direction:m,per_page:v},{preserveState:!0,replace:!0})},300)}},[d,m,v]),ie=s=>{K(s),ae(s)},b=s=>{const i=d===s&&m==="asc"?"desc":"asc";Q(s),W(i),j.get(k().url,{search:S,sort_by:s,sort_direction:i,per_page:v},{preserveState:!0,replace:!0})},ne=s=>{const i=parseInt(s);X(i),j.get(k().url,{search:S,sort_by:d,sort_direction:m,per_page:i},{preserveState:!0,replace:!0})},le=s=>{s.preventDefault(),a.post(ye(),{onFinish:()=>{a.reset(),M(!1)}})},ce=s=>{s.preventDefault(),t.put(Ce(t.data.id),{onFinish:()=>{t.reset(),P(!1)}})},oe=s=>{_(s),g(!0)},de=()=>{p.length>0?j.delete(z().url,{data:{ids:p},onSuccess:()=>{D([]),g(!1),j.reload()},onError:()=>{g(!1)}}):F&&j.delete(z(F.id).url,{onSuccess:()=>{g(!1),_(null)},onError:()=>{g(!1),_(null)}})},me=s=>{t.setData({id:s.id,name:s.name,category:s.category,cost_price:s.cost_price.toString(),selling_price:s.selling_price.toString(),current_stock:s.current_stock.toString(),minimum_stock:s.minimum_stock.toString(),description:s.description||""}),P(!0)},ue=s=>{s.preventDefault(),f.post(U.importMethod().url,{onSuccess:()=>{f.reset(),V(!1),j.reload()},onError:()=>{}})},L=s=>`${(typeof s=="string"?parseFloat(s):s).toFixed(2)} VT`,xe=s=>s.current_stock<=0?{status:"Out of Stock",color:"text-red-600 bg-red-50"}:s.current_stock<=s.minimum_stock?{status:"Low Stock",color:"text-orange-600 bg-orange-50"}:{status:"In Stock",color:"text-green-600 bg-green-50"},he=s=>s.current_stock<=0?"text-red-600 font-semibold":s.current_stock<=s.minimum_stock?"text-orange-600 font-semibold":"text-gray-900";return e.jsxs(be,{breadcrumbs:Ae,children:[e.jsx(je,{title:"Inventory"}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ve,{title:"Inventory Management",description:"Manage products, pricing, and stock levels"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{open:Y,onOpenChange:M,children:[e.jsx(E,{asChild:!0,children:e.jsx(u,{children:"Add Product"})}),e.jsxs(q,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(O,{children:[e.jsx(A,{children:"Add New Product"}),e.jsx($,{children:"Create a new product with pricing and stock information."})]}),e.jsxs("form",{onSubmit:le,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{htmlFor:"name",children:"Product Name *"}),e.jsx(l,{id:"name",type:"text",value:a.data.name,onChange:s=>a.setData("name",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"category",children:"Category *"}),e.jsx(l,{id:"category",type:"text",value:a.data.category,onChange:s=>a.setData("category",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"cost_price",children:"Cost Price (VT) *"}),e.jsx(l,{id:"cost_price",type:"number",step:"0.01",min:"0",value:a.data.cost_price,onChange:s=>a.setData("cost_price",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"selling_price",children:"Selling Price (VT) *"}),e.jsx(l,{id:"selling_price",type:"number",step:"0.01",min:"0",value:a.data.selling_price,onChange:s=>a.setData("selling_price",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"current_stock",children:"Current Stock *"}),e.jsx(l,{id:"current_stock",type:"number",min:"0",value:a.data.current_stock,onChange:s=>a.setData("current_stock",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"minimum_stock",children:"Minimum Stock *"}),e.jsx(l,{id:"minimum_stock",type:"number",min:"0",value:a.data.minimum_stock,onChange:s=>a.setData("minimum_stock",s.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx("textarea",{id:"description",value:a.data.description,onChange:s=>a.setData("description",s.target.value),className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:3})]})]}),e.jsx(H,{children:e.jsx(u,{type:"submit",disabled:a.processing,children:"Create Product"})})]})]})]}),e.jsxs(I,{open:ee,onOpenChange:V,children:[e.jsx(E,{asChild:!0,children:e.jsx(u,{variant:"outline",children:"Import Excel"})}),e.jsxs(q,{className:"sm:max-w-[425px]",children:[e.jsxs(O,{children:[e.jsx(A,{children:"Import Products from Excel"}),e.jsx($,{children:"Upload an Excel file (.xlsx or .xls) to import or update products."}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[e.jsx("a",{href:U.exportSample().url,target:"_blank",className:"text-blue-600 hover:text-blue-800 underline",children:"Download sample Excel format"}),"before uploading."]})]}),e.jsxs("form",{onSubmit:ue,className:"grid gap-4 py-4",encType:"multipart/form-data",children:[e.jsxs("div",{className:"grid items-center gap-4",children:[e.jsx(n,{htmlFor:"excel_file",className:"text-left",children:"Excel File"}),e.jsx(l,{id:"excel_file",type:"file",accept:".xlsx, .xls",onChange:s=>f.setData("file",s.target.files?s.target.files[0]:null),required:!0}),f.errors.file&&e.jsx("div",{className:"text-red-500 text-sm",children:f.errors.file})]}),e.jsx(H,{children:e.jsx(u,{type:"submit",disabled:f.processing,children:"Import"})})]})]})]}),p.length>0&&e.jsxs(u,{variant:"destructive",onClick:()=>g(!0),className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-4 w-4"}),"Delete Selected (",p.length,")"]})]})]}),e.jsx(R,{children:e.jsx(G,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(Oe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(l,{placeholder:"Search products...",value:S,onChange:s=>ie(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{htmlFor:"per-page",children:"Show:"}),e.jsxs(_e,{value:v.toString(),onValueChange:ne,children:[e.jsx(De,{className:"w-20",children:e.jsx(we,{})}),e.jsxs(Pe,{children:[e.jsx(w,{value:"10",children:"10"}),e.jsx(w,{value:"20",children:"20"}),e.jsx(w,{value:"50",children:"50"}),e.jsx(w,{value:"100",children:"100"})]})]})]})]})})}),e.jsxs(R,{children:[e.jsxs(ke,{children:[e.jsxs(Ne,{children:["Products (",c.total,")"]}),e.jsxs(Se,{children:[c.from,"-",c.to," of ",c.total," products"]})]}),e.jsxs(G,{children:[e.jsxs(Fe,{children:[e.jsx(Te,{children:e.jsxs(J,{children:[e.jsx(x,{className:"w-16",children:e.jsx(B,{checked:se,onCheckedChange:te,"aria-label":"Select all products"})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>b("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Product Name",d==="name"&&(m==="asc"?e.jsx(y,{className:"h-4 w-4"}):e.jsx(C,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>b("category"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Category",d==="category"&&(m==="asc"?e.jsx(y,{className:"h-4 w-4"}):e.jsx(C,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>b("cost_price"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Cost Price",d==="cost_price"&&(m==="asc"?e.jsx(y,{className:"h-4 w-4"}):e.jsx(C,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>b("selling_price"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Selling Price",d==="selling_price"&&(m==="asc"?e.jsx(y,{className:"h-4 w-4"}):e.jsx(C,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>b("current_stock"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Stock",d==="current_stock"&&(m==="asc"?e.jsx(y,{className:"h-4 w-4"}):e.jsx(C,{className:"h-4 w-4"}))]})}),e.jsx(x,{children:"Status"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Ie,{children:c.data.map(s=>{const i=xe(s);return e.jsxs(J,{children:[e.jsx(h,{children:e.jsx(B,{checked:p.includes(s.id),onCheckedChange:r=>re(s.id,r),"aria-label":`Select product ${s.name}`})}),e.jsx(h,{className:"font-medium",children:s.name}),e.jsx(h,{children:s.category}),e.jsx(h,{children:L(s.cost_price)}),e.jsx(h,{children:L(s.selling_price)}),e.jsxs(h,{className:he(s),children:[s.current_stock," / ",s.minimum_stock]}),e.jsx(h,{children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i.color}`,children:i.status})}),e.jsx(h,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{children:[e.jsx(E,{asChild:!0,children:e.jsx(u,{size:"sm",variant:"outline",onClick:()=>me(s),children:"Edit"})}),e.jsxs(q,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(O,{children:[e.jsx(A,{children:"Edit Product"}),e.jsx($,{children:"Update product information, pricing, and stock levels."})]}),e.jsxs("form",{onSubmit:ce,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{htmlFor:"edit-name",children:"Product Name *"}),e.jsx(l,{id:"edit-name",type:"text",value:t.data.name,onChange:r=>t.setData("name",r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-category",children:"Category *"}),e.jsx(l,{id:"edit-category",type:"text",value:t.data.category,onChange:r=>t.setData("category",r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-cost_price",children:"Cost Price (VT) *"}),e.jsx(l,{id:"edit-cost_price",type:"number",step:"0.01",min:"0",value:t.data.cost_price,onChange:r=>t.setData("cost_price",r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-selling_price",children:"Selling Price (VT) *"}),e.jsx(l,{id:"edit-selling_price",type:"number",step:"0.01",min:"0",value:t.data.selling_price,onChange:r=>t.setData("selling_price",r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-current_stock",children:"Current Stock *"}),e.jsx(l,{id:"edit-current_stock",type:"number",min:"0",value:t.data.current_stock,onChange:r=>t.setData("current_stock",r.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-minimum_stock",children:"Minimum Stock *"}),e.jsx(l,{id:"edit-minimum_stock",type:"number",min:"0",value:t.data.minimum_stock,onChange:r=>t.setData("minimum_stock",r.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{htmlFor:"edit-description",children:"Description"}),e.jsx("textarea",{id:"edit-description",value:t.data.description,onChange:r=>t.setData("description",r.target.value),className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:3})]})]}),e.jsxs(H,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>{t.reset(),P(!1)},children:"Cancel"}),e.jsx(u,{type:"submit",disabled:t.processing,children:"Update Product"})]})]})]})]}),e.jsx(u,{size:"sm",variant:"destructive",onClick:()=>oe(s),children:"Delete"})]})})]},s.id)})})]}),c.last_page>1&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("div",{className:"flex gap-2",children:Array.from({length:c.last_page},(s,i)=>i+1).map(s=>e.jsx(fe,{href:`${k().url}?page=${s}&search=${S}&sort_by=${d}&sort_direction=${m}&per_page=${v}`,className:`px-3 py-2 rounded ${s===c.current_page?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:s},s))})})]})]})]}),e.jsx(Ee,{isOpen:Z,onClose:()=>{g(!1),_(null)},onConfirm:de,itemName:F?.name||""})]})}export{is as default};
