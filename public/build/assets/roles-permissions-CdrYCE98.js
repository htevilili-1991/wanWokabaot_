import{c as ve,a as Z,b as ce,j as s,H as Se,r as Ce}from"./app-C_R9jF1x.js";import{c as _e,B as O}from"./app-logo-icon-BwBSu0IG.js";import{C as De,b as Re,c as we,a as ke}from"./card-DTVjJi2-.js";import{C as me}from"./checkbox-DmscgFs6.js";import{d as de,f as Pe,b as pe,c as he,e as xe,a as fe,D as ge}from"./dialog-C4npLh4v.js";import{I as je}from"./input-D-5Nmu-v.js";import{L as w}from"./label-CIPFvbyM.js";import{S as ue}from"./separator-B07_mmHQ.js";import{B as Ne}from"./badge-BZIuKSZg.js";import{H as Oe}from"./heading-E6zyScli.js";import{A as Fe}from"./app-layout-DKoOPHdo.js";import{S as $e}from"./layout-CU7-PMm-.js";import{P as Ee}from"./plus-C5DJo5sO.js";import{S as Ae}from"./square-pen-CLpDrEV2.js";import{T as He}from"./trash-2-DvCVVt08.js";/* empty css            */import"./index-Bkt3dTVR.js";import"./index-BaYRpaJE.js";import"./check-vl6QDcNS.js";import"./index-lGcX66cW.js";import"./index-DghwwTgB.js";const Te=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Le=_e("Shield",Te),Be=[{title:"Settings",href:"/settings/profile"},{title:"Roles & Permissions",href:"/settings/roles-permissions"}];function ds(r){const e=ve.c(81),{roles:ee,permissions:o}=r,[c,re]=Z.useState(!1),[se,te]=Z.useState(!1),[F,oe]=Z.useState(null);let $;e[0]===Symbol.for("react.memo_cache_sentinel")?($=[],e[0]=$):$=e[0];const[,be]=Z.useState($);let E;e[1]===Symbol.for("react.memo_cache_sentinel")?(E=[],e[1]=E):E=e[1];let A;e[2]===Symbol.for("react.memo_cache_sentinel")?(A={name:"",permissions:E},e[2]=A):A=e[2];const a=ce(A);let H;e[3]===Symbol.for("react.memo_cache_sentinel")?(H=[],e[3]=H):H=e[3];let T;e[4]===Symbol.for("react.memo_cache_sentinel")?(T={name:"",permissions:H},e[4]=T):T=e[4];const t=ce(T);let L;e[5]!==a?(L=()=>{a.post("/settings/roles-permissions",{onSuccess:()=>{re(!1),a.reset()}})},e[5]=a,e[6]=L):L=e[6];const ae=L;let B;e[7]!==t?(B=i=>{oe(i),t.setData({name:i.name,permissions:i.permissions.map(Ue)}),be(i.permissions.map(Ie)),te(!0)},e[7]=t,e[8]=B):B=e[8];const k=B;let M;e[9]!==t||e[10]!==F?(M=()=>{F&&t.put(`/settings/roles-permissions/${F.id}`,{onSuccess:()=>{te(!1),oe(null),t.reset()}})},e[9]=t,e[10]=F,e[11]=M):M=e[11];const ie=M,ye=ze;let z;e[12]!==c||e[13]!==a||e[14]!==t?(z=(i,l)=>{const R=c?a.data.permissions:t.data.permissions;if(l){const n=[...R,i];c?a.setData("permissions",n):t.setData("permissions",n)}else{const n=R.filter(P=>P!==i);c?a.setData("permissions",n):t.setData("permissions",n)}},e[12]=c,e[13]=a,e[14]=t,e[15]=z):z=e[15];const m=z;let I,U;e[16]===Symbol.for("react.memo_cache_sentinel")?(I=s.jsx(Se,{title:"Roles & Permissions"}),U=s.jsx("h1",{className:"sr-only",children:"Roles & Permissions"}),e[16]=I,e[17]=U):(I=e[16],U=e[17]);let q;e[18]===Symbol.for("react.memo_cache_sentinel")?(q=s.jsx(Oe,{title:"Roles & Permissions",description:"Manage user roles and their permissions"}),e[18]=q):q=e[18];let V;e[19]===Symbol.for("react.memo_cache_sentinel")?(V=s.jsx(Pe,{asChild:!0,children:s.jsxs(O,{children:[s.jsx(Ee,{className:"mr-2 h-4 w-4"}),"Create Role"]})}),e[19]=V):V=e[19];let G;e[20]===Symbol.for("react.memo_cache_sentinel")?(G=s.jsxs(pe,{children:[s.jsx(he,{children:"Create New Role"}),s.jsx(xe,{children:"Define a new role and assign permissions to it."})]}),e[20]=G):G=e[20];let J;e[21]===Symbol.for("react.memo_cache_sentinel")?(J=s.jsx(w,{htmlFor:"name",className:"text-right",children:"Role Name"}),e[21]=J):J=e[21];let d;e[22]!==a?(d=i=>a.setData("name",i.target.value),e[22]=a,e[23]=d):d=e[23];let p;e[24]!==a.data.name||e[25]!==d?(p=s.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[J,s.jsx(je,{id:"name",value:a.data.name,onChange:d,className:"col-span-3",placeholder:"e.g., Manager, Auditor"})]}),e[24]=a.data.name,e[25]=d,e[26]=p):p=e[26];let K;e[27]===Symbol.for("react.memo_cache_sentinel")?(K=s.jsx(w,{className:"text-right pt-2",children:"Permissions"}),e[27]=K):K=e[27];let h;e[28]!==a.data.permissions||e[29]!==o||e[30]!==m?(h=s.jsxs("div",{className:"grid grid-cols-4 items-start gap-4",children:[K,s.jsx("div",{className:"col-span-3 h-64 border rounded-md p-4 overflow-y-auto",children:s.jsx("div",{className:"space-y-4",children:Object.entries(o).map(i=>{const[l,R]=i;return s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-sm text-muted-foreground uppercase tracking-wide mb-2",children:l.replace("_"," ")}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:R.map(n=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(me,{id:`create-${n.name}`,checked:a.data.permissions.includes(n.name),onCheckedChange:P=>m(n.name,P)}),s.jsx(w,{htmlFor:`create-${n.name}`,className:"text-sm font-normal",children:n.name.replace("_"," ")})]},n.id))}),l!==Object.keys(o)[Object.keys(o).length-1]&&s.jsx(ue,{className:"mt-4"})]},l)})})})]}),e[28]=a.data.permissions,e[29]=o,e[30]=m,e[31]=h):h=e[31];let x;e[32]!==p||e[33]!==h?(x=s.jsxs("div",{className:"grid gap-4 py-4",children:[p,h]}),e[32]=p,e[33]=h,e[34]=x):x=e[34];const le=a.processing?"Creating...":"Create Role";let f;e[35]!==a.processing||e[36]!==ae||e[37]!==le?(f=s.jsx(de,{children:s.jsx(O,{type:"submit",onClick:ae,disabled:a.processing,children:le})}),e[35]=a.processing,e[36]=ae,e[37]=le,e[38]=f):f=e[38];let g;e[39]!==x||e[40]!==f?(g=s.jsxs(fe,{className:"max-w-2xl max-h-[80vh]",children:[G,x,f]}),e[39]=x,e[40]=f,e[41]=g):g=e[41];let j;e[42]!==c||e[43]!==g?(j=s.jsxs("div",{className:"flex items-center justify-between",children:[q,s.jsxs(ge,{open:c,onOpenChange:re,children:[V,g]})]}),e[42]=c,e[43]=g,e[44]=j):j=e[44];let u;if(e[45]!==k||e[46]!==ee){let i;e[48]!==k?(i=l=>s.jsxs(De,{children:[s.jsxs(Re,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[s.jsxs(we,{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(Le,{className:"h-4 w-4"}),l.name]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(O,{variant:"ghost",size:"sm",onClick:()=>k(l),disabled:l.name==="Super Admin",children:s.jsx(Ae,{className:"h-4 w-4"})}),s.jsx(O,{variant:"ghost",size:"sm",onClick:()=>ye(l),disabled:l.name==="Super Admin",className:"text-destructive hover:text-destructive",children:s.jsx(He,{className:"h-4 w-4"})})]})]}),s.jsxs(ke,{children:[s.jsx("div",{className:"text-2xl font-bold",children:l.permissions.length}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"permissions assigned"}),s.jsxs("div",{className:"mt-4 flex flex-wrap gap-1",children:[l.permissions.slice(0,3).map(Me),l.permissions.length>3&&s.jsxs(Ne,{variant:"outline",className:"text-xs",children:["+",l.permissions.length-3," more"]})]})]})]},l.id),e[48]=k,e[49]=i):i=e[49],u=ee.map(i),e[45]=k,e[46]=ee,e[47]=u}else u=e[47];let N;e[50]!==u?(N=s.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:u}),e[50]=u,e[51]=N):N=e[51];let Q;e[52]===Symbol.for("react.memo_cache_sentinel")?(Q=s.jsxs(pe,{children:[s.jsx(he,{children:"Edit Role"}),s.jsx(xe,{children:"Modify the role name and permissions."})]}),e[52]=Q):Q=e[52];let W;e[53]===Symbol.for("react.memo_cache_sentinel")?(W=s.jsx(w,{htmlFor:"edit-name",className:"text-right",children:"Role Name"}),e[53]=W):W=e[53];let b;e[54]!==t?(b=i=>t.setData("name",i.target.value),e[54]=t,e[55]=b):b=e[55];let y;e[56]!==t.data.name||e[57]!==b?(y=s.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[W,s.jsx(je,{id:"edit-name",value:t.data.name,onChange:b,className:"col-span-3"})]}),e[56]=t.data.name,e[57]=b,e[58]=y):y=e[58];let X;e[59]===Symbol.for("react.memo_cache_sentinel")?(X=s.jsx(w,{className:"text-right pt-2",children:"Permissions"}),e[59]=X):X=e[59];let v;e[60]!==t.data.permissions||e[61]!==o||e[62]!==m?(v=s.jsxs("div",{className:"grid grid-cols-4 items-start gap-4",children:[X,s.jsx("div",{className:"col-span-3 h-64 border rounded-md p-4 overflow-y-auto",children:s.jsx("div",{className:"space-y-4",children:Object.entries(o).map(i=>{const[l,R]=i;return s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-sm text-muted-foreground uppercase tracking-wide mb-2",children:l.replace("_"," ")}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:R.map(n=>s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(me,{id:`edit-${n.name}`,checked:t.data.permissions.includes(n.name),onCheckedChange:P=>m(n.name,P)}),s.jsx(w,{htmlFor:`edit-${n.name}`,className:"text-sm font-normal",children:n.name.replace("_"," ")})]},n.id))}),l!==Object.keys(o)[Object.keys(o).length-1]&&s.jsx(ue,{className:"mt-4"})]},l)})})})]}),e[60]=t.data.permissions,e[61]=o,e[62]=m,e[63]=v):v=e[63];let S;e[64]!==y||e[65]!==v?(S=s.jsxs("div",{className:"grid gap-4 py-4",children:[y,v]}),e[64]=y,e[65]=v,e[66]=S):S=e[66];const ne=t.processing?"Updating...":"Update Role";let C;e[67]!==t.processing||e[68]!==ie||e[69]!==ne?(C=s.jsx(de,{children:s.jsx(O,{type:"submit",onClick:ie,disabled:t.processing,children:ne})}),e[67]=t.processing,e[68]=ie,e[69]=ne,e[70]=C):C=e[70];let _;e[71]!==S||e[72]!==C?(_=s.jsxs(fe,{className:"max-w-2xl max-h-[80vh]",children:[Q,S,C]}),e[71]=S,e[72]=C,e[73]=_):_=e[73];let D;e[74]!==se||e[75]!==_?(D=s.jsx(ge,{open:se,onOpenChange:te,children:_}),e[74]=se,e[75]=_,e[76]=D):D=e[76];let Y;return e[77]!==j||e[78]!==N||e[79]!==D?(Y=s.jsxs(Fe,{breadcrumbs:Be,children:[I,U,s.jsx($e,{children:s.jsxs("div",{className:"space-y-6",children:[j,N,D]})})]}),e[77]=j,e[78]=N,e[79]=D,e[80]=Y):Y=e[80],Y}function Me(r){return s.jsx(Ne,{variant:"secondary",className:"text-xs",children:r.name.split(" ")[0]},r.id)}function ze(r){confirm(`Are you sure you want to delete the "${r.name}" role? This action cannot be undone.`)&&Ce.delete(`/settings/roles-permissions/${r.id}`)}function Ie(r){return r.name}function Ue(r){return r.name}export{ds as default};
