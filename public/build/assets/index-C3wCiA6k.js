import{u as je,a as c,b as V,r as g,j as e,H as ge,L as ve}from"./app-C_R9jF1x.js";import{C as I}from"./checkbox-DmscgFs6.js";import{H as be}from"./heading-E6zyScli.js";import{n as y,A as fe,o as Ce,p as ye,q as $}from"./app-layout-DKoOPHdo.js";import{B as v}from"./app-logo-icon-BwBSu0IG.js";import{C as O,a as B,b as Ne,c as Se,d as De}from"./card-DTVjJi2-.js";import{D as H,f as q,a as L,b as U,c as z,e as J,d as R}from"./dialog-C4npLh4v.js";import{I as l}from"./input-D-5Nmu-v.js";import{L as n}from"./label-CIPFvbyM.js";import{d as F,a as M,b as k,c as A,S as h,C as b,e as f}from"./select-DdUXmIzL.js";import{e as we,c as _e,T as G,b as x,d as Te,a as m}from"./table-Bosz4qyP.js";import{D as Fe}from"./delete-confirmation-popover-BxYihECp.js";import{T as Me}from"./trash-2-DvCVVt08.js";import{S as ke}from"./search-BXiL5jgi.js";/* empty css            */import"./index-Bkt3dTVR.js";import"./index-BaYRpaJE.js";import"./check-vl6QDcNS.js";import"./index-lGcX66cW.js";import"./triangle-alert-fY-VY7ce.js";const Ae=[{title:"Members",href:y().url}];function ea({members:i,filters:N}){const{flash:Pe}=je().props,[S,K]=c.useState(N.search||""),[d,Q]=c.useState(N.sort_by||"created_at"),[o,W]=c.useState(N.sort_direction||"desc"),[C,X]=c.useState(N.per_page||10),[Y,P]=c.useState(!1),[Z,_]=c.useState(!1),[ee,u]=c.useState(!1),[T,D]=c.useState(null),[p,w]=c.useState([]),ae=c.useMemo(()=>i.data.length>0&&p.length===i.data.length,[i.data,p]),se=a=>{w(a?i.data.map(s=>s.id):[])},te=(a,s)=>{w(E=>s?[...E,a]:E.filter(pe=>pe!==a))},r=V({name:"",email:"",phone:"",member_code:"",join_date:"",status:"Active",notes:"",total_spent:"",balance:""}),t=V({id:"",name:"",email:"",phone:"",member_code:"",join_date:"",status:"Active",notes:"",total_spent:"",balance:""}),re=c.useMemo(()=>{let a;return s=>{clearTimeout(a),a=setTimeout(()=>{g.get(y().url,{search:s,sort_by:d,sort_direction:o,per_page:C},{preserveState:!0,replace:!0})},300)}},[d,o,C]),ne=a=>{K(a),re(a)},j=a=>{const s=d===a&&o==="asc"?"desc":"asc";Q(a),W(s),g.get(y().url,{search:S,sort_by:a,sort_direction:s,per_page:C},{preserveState:!0,replace:!0})},le=a=>{const s=parseInt(a);X(s),g.get(y().url,{search:S,sort_by:d,sort_direction:o,per_page:s},{preserveState:!0,replace:!0})},ie=a=>{a.preventDefault(),r.post(Ce(),{onFinish:()=>{r.reset(),P(!1)}})},de=a=>{a.preventDefault(),t.put(ye(t.data.id),{onSuccess:()=>{t.reset(),_(!1)}})},oe=a=>{D(a),u(!0)},ce=()=>{p.length>0?g.delete($().url,{data:{ids:p},onSuccess:()=>{w([]),u(!1),g.reload()},onError:()=>{u(!1)}}):T&&g.delete($(T.id).url,{onSuccess:()=>{u(!1),D(null)},onError:()=>{u(!1),D(null)}})},he=a=>{t.setData({id:a.id,name:a.name,email:a.email,phone:a.phone||"",member_code:a.member_code||"",join_date:a.join_date,status:a.status,notes:a.notes||"",total_spent:(a.total_spent??0).toString(),balance:(a.balance??0).toString()}),_(!0)},xe=a=>{switch(a){case"Active":return"bg-green-100 text-green-800 border-green-200";case"Inactive":return"bg-gray-100 text-gray-800 border-gray-200";case"Suspended":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},me=a=>a>=2e3?"bg-red-100 text-red-800 font-semibold px-2 py-1 rounded-md border border-red-200":"text-gray-900",ue=a=>`${(typeof a=="string"?parseFloat(a):a).toFixed(2)} VT`;return e.jsxs(fe,{breadcrumbs:Ae,children:[e.jsx(ge,{title:"Members"}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(be,{title:"Members",description:"Manage member information, balances, and status"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(H,{open:Y,onOpenChange:P,children:[e.jsx(q,{asChild:!0,children:e.jsx(v,{children:"Add Member"})}),e.jsxs(L,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(U,{children:[e.jsx(z,{children:"Add New Member"}),e.jsx(J,{children:"Create a new member record with their details."})]}),e.jsxs("form",{onSubmit:ie,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"name",children:"Name *"}),e.jsx(l,{id:"name",type:"text",value:r.data.name,onChange:a=>r.setData("name",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"email",children:"Email *"}),e.jsx(l,{id:"email",type:"email",value:r.data.email,onChange:a=>r.setData("email",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"phone",children:"Phone"}),e.jsx(l,{id:"phone",type:"tel",value:r.data.phone,onChange:a=>r.setData("phone",a.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"member_code",children:"Member Code"}),e.jsx(l,{id:"member_code",type:"text",value:r.data.member_code,onChange:a=>r.setData("member_code",a.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"join_date",children:"Join Date *"}),e.jsx(l,{id:"join_date",type:"date",value:r.data.join_date,onChange:a=>r.setData("join_date",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"status",children:"Status *"}),e.jsxs(F,{value:r.data.status,onValueChange:a=>r.setData("status",a),children:[e.jsx(M,{children:e.jsx(k,{placeholder:"Select status"})}),e.jsxs(A,{children:[e.jsx(h,{value:"Active",children:"Active"}),e.jsx(h,{value:"Inactive",children:"Inactive"}),e.jsx(h,{value:"Suspended",children:"Suspended"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{htmlFor:"notes",children:"Notes"}),e.jsx("textarea",{id:"notes",name:"notes",value:r.data.notes,onChange:a=>r.setData("notes",a.target.value),className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:3})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"total_spent",children:"Total Spent (VT)"}),e.jsx(l,{id:"total_spent",type:"number",step:"0.01",min:"0",value:r.data.total_spent,onChange:a=>r.setData("total_spent",a.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"balance",children:"Balance (VT)"}),e.jsx(l,{id:"balance",type:"number",step:"0.01",min:"0",value:r.data.balance,onChange:a=>r.setData("balance",a.target.value)})]})]}),e.jsx(R,{children:e.jsx(v,{type:"submit",children:"Create Member"})})]})]})]}),p.length>0&&e.jsxs(v,{variant:"destructive",onClick:()=>u(!0),className:"flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),"Delete Selected (",p.length,")"]})]})]}),e.jsx(O,{children:e.jsx(B,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(l,{placeholder:"Search members...",value:S,onChange:a=>ne(a.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{htmlFor:"per-page",children:"Show:"}),e.jsxs(F,{value:C.toString(),onValueChange:le,children:[e.jsx(M,{className:"w-20",children:e.jsx(k,{})}),e.jsxs(A,{children:[e.jsx(h,{value:"10",children:"10"}),e.jsx(h,{value:"20",children:"20"}),e.jsx(h,{value:"50",children:"50"}),e.jsx(h,{value:"100",children:"100"})]})]})]})]})})}),e.jsxs(O,{children:[e.jsxs(Ne,{children:[e.jsxs(Se,{children:["Members (",i.total,")"]}),e.jsxs(De,{children:[i.from,"-",i.to," of ",i.total," members"]})]}),e.jsxs(B,{children:[e.jsxs(we,{children:[e.jsx(_e,{children:e.jsxs(G,{children:[e.jsx(x,{className:"w-16",children:e.jsx(I,{checked:ae,onCheckedChange:se,"aria-label":"Select all members"})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>j("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Name",d==="name"&&(o==="asc"?e.jsx(b,{className:"h-4 w-4"}):e.jsx(f,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>j("email"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Email",d==="email"&&(o==="asc"?e.jsx(b,{className:"h-4 w-4"}):e.jsx(f,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>j("phone"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Phone",d==="phone"&&(o==="asc"?e.jsx(b,{className:"h-4 w-4"}):e.jsx(f,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>j("status"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Status",d==="status"&&(o==="asc"?e.jsx(b,{className:"h-4 w-4"}):e.jsx(f,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>j("balance"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Total Unpaid (VT)",d==="balance"&&(o==="asc"?e.jsx(b,{className:"h-4 w-4"}):e.jsx(f,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>j("total_spent"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Total Spent (VT)",d==="total_spent"&&(o==="asc"?e.jsx(b,{className:"h-4 w-4"}):e.jsx(f,{className:"h-4 w-4"}))]})}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Te,{children:i.data.map(a=>e.jsxs(G,{children:[e.jsx(m,{children:e.jsx(I,{checked:p.includes(a.id),onCheckedChange:s=>te(a.id,s),"aria-label":`Select member ${a.name}`})}),e.jsx(m,{className:"font-medium",children:a.name}),e.jsx(m,{children:a.email}),e.jsx(m,{children:a.phone||"-"}),e.jsx(m,{children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-lg text-xs font-semibold border ${xe(a.status)}`,children:a.status})}),e.jsx(m,{children:e.jsxs("div",{className:me(a.balance),children:[a.unpaid_total," VT"]})}),e.jsxs(m,{children:[ue(a.total_spent)," VT"]}),e.jsx(m,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(H,{open:Z,onOpenChange:_,children:[e.jsx(q,{asChild:!0,children:e.jsx(v,{size:"sm",variant:"outline",onClick:()=>he(a),children:"Edit"})}),e.jsxs(L,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(U,{children:[e.jsx(z,{children:"Edit Member"}),e.jsx(J,{children:"Update member information and details."})]}),e.jsxs("form",{onSubmit:de,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-name",children:"Name *"}),e.jsx(l,{id:"edit-name",type:"text",value:t.data.name,onChange:s=>t.setData("name",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-email",children:"Email *"}),e.jsx(l,{id:"edit-email",type:"email",value:t.data.email,onChange:s=>t.setData("email",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-phone",children:"Phone"}),e.jsx(l,{id:"edit-phone",type:"tel",value:t.data.phone,onChange:s=>t.setData("phone",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-member-code",children:"Member Code"}),e.jsx(l,{id:"edit-member-code",type:"text",value:t.data.member_code,onChange:s=>t.setData("member_code",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-join-date",children:"Join Date *"}),e.jsx(l,{id:"edit-join-date",type:"date",value:t.data.join_date,onChange:s=>t.setData("join_date",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-status",children:"Status *"}),e.jsxs(F,{value:t.data.status,onValueChange:s=>t.setData("status",s),children:[e.jsx(M,{children:e.jsx(k,{})}),e.jsxs(A,{children:[e.jsx(h,{value:"Active",children:"Active"}),e.jsx(h,{value:"Inactive",children:"Inactive"}),e.jsx(h,{value:"Suspended",children:"Suspended"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{htmlFor:"edit-notes",children:"Notes"}),e.jsx("textarea",{id:"edit-notes",value:t.data.notes,onChange:s=>t.setData("notes",s.target.value),className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:3})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-total-spent",children:"Total Spent (VT)"}),e.jsx(l,{id:"edit-total-spent",type:"number",step:"0.01",min:"0",value:t.data.total_spent,onChange:s=>t.setData("total_spent",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-balance",children:"Balance (VT)"}),e.jsx(l,{id:"edit-balance",type:"number",step:"0.01",min:"0",value:t.data.balance,onChange:s=>t.setData("balance",s.target.value)})]})]}),e.jsx(R,{children:e.jsx(v,{type:"submit",disabled:t.processing,children:"Update Member"})})]})]})]}),e.jsx(v,{size:"sm",variant:"destructive",onClick:()=>oe(a),children:"Delete"})]})})]},a.id))})]}),i.last_page>1&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("div",{className:"flex gap-2",children:Array.from({length:i.last_page},(a,s)=>s+1).map(a=>e.jsx(ve,{href:`${y().url}?page=${a}&search=${S}&sort_by=${d}&sort_direction=${o}&per_page=${C}`,className:`px-3 py-2 rounded ${a===i.current_page?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:a},a))})})]})]})]}),e.jsx(Fe,{isOpen:ee,onClose:()=>{u(!1),D(null)},onConfirm:ce,itemName:T?.name||""})]})}export{ea as default};
