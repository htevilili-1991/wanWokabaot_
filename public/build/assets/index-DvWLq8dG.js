import{u as le,r as c,a as A,b as D,j as e,H as ie,L as oe}from"./app-BQpvbsYM.js";import{H as de}from"./heading-C9cQyCZn.js";import{l as b,A as ce,n as he,o as me,p as xe}from"./app-layout-CknbTmax.js";import{B as v}from"./app-logo-icon-DNdOGlss.js";import{C as P,d as k,a as ue,b as pe,c as je}from"./card-B7YBDAfy.js";import{e as I,f as V,d as E,b as $,D as B,a as H,c as O}from"./dialog-DBFOUhRl.js";import{I as l}from"./input-BJnsw0Sr.js";import{L as n}from"./label-C9gNfmco.js";import{S as _,a as T,b as F,c as M,d,C as p,e as j}from"./select-f5x-omt8.js";import{d as ge,b as ve,T as q,c as m,e as be,a as x}from"./table-CZxfTnp_.js";import{D as fe}from"./delete-confirmation-popover-C7KNC-c9.js";import{S as ye}from"./search-bMCPR2d6.js";/* empty css            */import"./index-DzG82ypG.js";import"./index-BHCUIMnc.js";import"./index-CIDq8xCX.js";import"./check-4MNCOR66.js";import"./triangle-alert-CNakOKEQ.js";const Ce=[{title:"Members",href:b().url}];function Ue({members:h,filters:f}){const{flash:Ne}=le().props,[y,L]=c.useState(f.search||""),[i,U]=c.useState(f.sort_by||"created_at"),[o,z]=c.useState(f.sort_direction||"desc"),[g,J]=c.useState(f.per_page||10),[De,R]=c.useState(!1),[G,S]=c.useState(!1),[K,C]=c.useState(!1),[w,N]=c.useState(null),r=A({name:"",email:"",phone:"",member_code:"",join_date:"",status:"Active",notes:"",total_spent:"",balance:""}),t=A({id:"",name:"",email:"",phone:"",member_code:"",join_date:"",status:"Active",notes:"",total_spent:"",balance:""}),Q=c.useMemo(()=>{let a;return s=>{clearTimeout(a),a=setTimeout(()=>{D.get(b().url,{search:s,sort_by:i,sort_direction:o,per_page:g},{preserveState:!0,replace:!0})},300)}},[i,o,g]),W=a=>{L(a),Q(a)},u=a=>{const s=i===a&&o==="asc"?"desc":"asc";U(a),z(s),D.get(b().url,{search:y,sort_by:a,sort_direction:s,per_page:g},{preserveState:!0,replace:!0})},X=a=>{const s=parseInt(a);J(s),D.get(b().url,{search:y,sort_by:i,sort_direction:o,per_page:s},{preserveState:!0,replace:!0})},Y=a=>{a.preventDefault(),r.post(he(),{onFinish:()=>{r.reset(),R(!1)}})},Z=a=>{a.preventDefault(),t.put(me(t.data.id),{onSuccess:()=>{t.reset(),S(!1)}})},ee=a=>{N(a),C(!0)},ae=()=>{w&&D.delete(xe(w.id).url,{onSuccess:()=>{C(!1),N(null)},onError:()=>{C(!1),N(null)}})},se=a=>{t.setData({id:a.id,name:a.name,email:a.email,phone:a.phone||"",member_code:a.member_code||"",join_date:a.join_date,status:a.status,notes:a.notes||"",total_spent:(a.total_spent??0).toString(),balance:(a.balance??0).toString()}),S(!0)},te=a=>{switch(a){case"Active":return"bg-green-100 text-green-800 border-green-200";case"Inactive":return"bg-gray-100 text-gray-800 border-gray-200";case"Suspended":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},re=a=>a>=2e3?"bg-red-100 text-red-800 font-semibold px-2 py-1 rounded-md border border-red-200":"text-gray-900",ne=a=>`${(typeof a=="string"?parseFloat(a):a).toFixed(2)} VT`;return e.jsxs(ce,{breadcrumbs:Ce,children:[e.jsx(ie,{title:"Members"}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(de,{title:"Members",description:"Manage member information, balances, and status"}),e.jsxs(I,{children:[e.jsx(V,{asChild:!0,children:e.jsx(v,{children:"Add Member"})}),e.jsxs(E,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs($,{children:[e.jsx(B,{children:"Add New Member"}),e.jsx(H,{children:"Create a new member record with their details."})]}),e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"name",children:"Name *"}),e.jsx(l,{id:"name",type:"text",value:r.data.name,onChange:a=>r.setData("name",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"email",children:"Email *"}),e.jsx(l,{id:"email",type:"email",value:r.data.email,onChange:a=>r.setData("email",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"phone",children:"Phone"}),e.jsx(l,{id:"phone",type:"tel",value:r.data.phone,onChange:a=>r.setData("phone",a.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"member_code",children:"Member Code"}),e.jsx(l,{id:"member_code",type:"text",value:r.data.member_code,onChange:a=>r.setData("member_code",a.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"join_date",children:"Join Date *"}),e.jsx(l,{id:"join_date",type:"date",value:r.data.join_date,onChange:a=>r.setData("join_date",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"status",children:"Status *"}),e.jsxs(_,{value:r.data.status,onValueChange:a=>r.setData("status",a),children:[e.jsx(T,{children:e.jsx(F,{placeholder:"Select status"})}),e.jsxs(M,{children:[e.jsx(d,{value:"Active",children:"Active"}),e.jsx(d,{value:"Inactive",children:"Inactive"}),e.jsx(d,{value:"Suspended",children:"Suspended"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{htmlFor:"notes",children:"Notes"}),e.jsx("textarea",{id:"notes",name:"notes",value:r.data.notes,onChange:a=>r.setData("notes",a.target.value),className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:3})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"total_spent",children:"Total Spent (VT)"}),e.jsx(l,{id:"total_spent",type:"number",step:"0.01",min:"0",value:r.data.total_spent,onChange:a=>r.setData("total_spent",a.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"balance",children:"Balance (VT)"}),e.jsx(l,{id:"balance",type:"number",step:"0.01",min:"0",value:r.data.balance,onChange:a=>r.setData("balance",a.target.value)})]})]}),e.jsx(O,{children:e.jsx(v,{type:"submit",children:"Create Member"})})]})]})]})]}),e.jsx(P,{children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(ye,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(l,{placeholder:"Search members...",value:y,onChange:a=>W(a.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{htmlFor:"per-page",children:"Show:"}),e.jsxs(_,{value:g.toString(),onValueChange:X,children:[e.jsx(T,{className:"w-20",children:e.jsx(F,{})}),e.jsxs(M,{children:[e.jsx(d,{value:"10",children:"10"}),e.jsx(d,{value:"20",children:"20"}),e.jsx(d,{value:"50",children:"50"}),e.jsx(d,{value:"100",children:"100"})]})]})]})]})})}),e.jsxs(P,{children:[e.jsxs(ue,{children:[e.jsxs(pe,{children:["Members (",h.total,")"]}),e.jsxs(je,{children:[h.from,"-",h.to," of ",h.total," members"]})]}),e.jsxs(k,{children:[e.jsxs(ge,{children:[e.jsx(ve,{children:e.jsxs(q,{children:[e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Name",i==="name"&&(o==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("email"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Email",i==="email"&&(o==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("phone"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Phone",i==="phone"&&(o==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("status"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Status",i==="status"&&(o==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("balance"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Total Unpaid (VT)",i==="balance"&&(o==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("total_spent"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Total Spent (VT)",i==="total_spent"&&(o==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{children:"Actions"})]})}),e.jsx(be,{children:h.data.map(a=>e.jsxs(q,{children:[e.jsx(x,{className:"font-medium",children:a.name}),e.jsx(x,{children:a.email}),e.jsx(x,{children:a.phone||"-"}),e.jsx(x,{children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-lg text-xs font-semibold border ${te(a.status)}`,children:a.status})}),e.jsx(x,{children:e.jsxs("div",{className:re(a.balance),children:[a.unpaid_total," VT"]})}),e.jsxs(x,{children:[ne(a.total_spent)," VT"]}),e.jsx(x,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{open:G,onOpenChange:S,children:[e.jsx(V,{asChild:!0,children:e.jsx(v,{size:"sm",variant:"outline",onClick:()=>se(a),children:"Edit"})}),e.jsxs(E,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs($,{children:[e.jsx(B,{children:"Edit Member"}),e.jsx(H,{children:"Update member information and details."})]}),e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-name",children:"Name *"}),e.jsx(l,{id:"edit-name",type:"text",value:t.data.name,onChange:s=>t.setData("name",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-email",children:"Email *"}),e.jsx(l,{id:"edit-email",type:"email",value:t.data.email,onChange:s=>t.setData("email",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-phone",children:"Phone"}),e.jsx(l,{id:"edit-phone",type:"tel",value:t.data.phone,onChange:s=>t.setData("phone",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-member-code",children:"Member Code"}),e.jsx(l,{id:"edit-member-code",type:"text",value:t.data.member_code,onChange:s=>t.setData("member_code",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-join-date",children:"Join Date *"}),e.jsx(l,{id:"edit-join-date",type:"date",value:t.data.join_date,onChange:s=>t.setData("join_date",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-status",children:"Status *"}),e.jsxs(_,{value:t.data.status,onValueChange:s=>t.setData("status",s),children:[e.jsx(T,{children:e.jsx(F,{})}),e.jsxs(M,{children:[e.jsx(d,{value:"Active",children:"Active"}),e.jsx(d,{value:"Inactive",children:"Inactive"}),e.jsx(d,{value:"Suspended",children:"Suspended"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{htmlFor:"edit-notes",children:"Notes"}),e.jsx("textarea",{id:"edit-notes",value:t.data.notes,onChange:s=>t.setData("notes",s.target.value),className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:3})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-total-spent",children:"Total Spent (VT)"}),e.jsx(l,{id:"edit-total-spent",type:"number",step:"0.01",min:"0",value:t.data.total_spent,onChange:s=>t.setData("total_spent",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-balance",children:"Balance (VT)"}),e.jsx(l,{id:"edit-balance",type:"number",step:"0.01",min:"0",value:t.data.balance,onChange:s=>t.setData("balance",s.target.value)})]})]}),e.jsx(O,{children:e.jsx(v,{type:"submit",disabled:t.processing,children:"Update Member"})})]})]})]}),e.jsx(v,{size:"sm",variant:"destructive",onClick:()=>ee(a),children:"Delete"})]})})]},a.id))})]}),h.last_page>1&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("div",{className:"flex gap-2",children:Array.from({length:h.last_page},(a,s)=>s+1).map(a=>e.jsx(oe,{href:`${b().url}?page=${a}&search=${y}&sort_by=${i}&sort_direction=${o}&per_page=${g}`,className:`px-3 py-2 rounded ${a===h.current_page?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:a},a))})})]})]})]}),e.jsx(fe,{isOpen:K,onClose:()=>{C(!1),N(null)},onConfirm:ae,itemName:w?.name||""})]})}export{Ue as default};
