import{u as ce,r as d,a as P,b as f,j as e,H as oe,L as de}from"./app-BQpvbsYM.js";import{H as me}from"./heading-C9cQyCZn.js";import{g as y,A as ue,h as L,j as xe,u as he,k as pe}from"./app-layout-CknbTmax.js";import{B as u}from"./app-logo-icon-DNdOGlss.js";import{C as M,d as B,a as ge,b as je,c as fe}from"./card-B7YBDAfy.js";import{e as F,f as T,d as I,b as E,D as q,a as O,c as $}from"./dialog-DBFOUhRl.js";import{I as i}from"./input-BJnsw0Sr.js";import{L as a}from"./label-C9gNfmco.js";import{S as ve,a as be,b as ye,c as _e,d as S,C as v,e as b}from"./select-f5x-omt8.js";import{d as Ce,b as ke,T as U,c as x,e as Ne,a as h}from"./table-CZxfTnp_.js";import{D as Se}from"./delete-confirmation-popover-C7KNC-c9.js";import{S as De}from"./search-bMCPR2d6.js";/* empty css            */import"./index-DzG82ypG.js";import"./index-BHCUIMnc.js";import"./index-CIDq8xCX.js";import"./check-4MNCOR66.js";import"./triangle-alert-CNakOKEQ.js";const we=[{title:"Inventory",href:y().url}];function Qe({products:m,filters:_}){const{flash:Pe}=ce().props,[C,z]=d.useState(_.search||""),[c,R]=d.useState(_.sort_by||"created_at"),[o,G]=d.useState(_.sort_direction||"desc"),[g,J]=d.useState(_.per_page||10),[K,A]=d.useState(!1),[Fe,D]=d.useState(!1),[Q,k]=d.useState(!1),[w,N]=d.useState(null),[W,H]=d.useState(!1),r=P({name:"",category:"",cost_price:"",selling_price:"",current_stock:"",minimum_stock:"",description:""}),t=P({id:"",name:"",category:"",cost_price:"",selling_price:"",current_stock:"",minimum_stock:"",description:""}),p=P({file:null}),X=d.useMemo(()=>{let s;return n=>{clearTimeout(s),s=setTimeout(()=>{f.get(y().url,{search:n,sort_by:c,sort_direction:o,per_page:g},{preserveState:!0,replace:!0})},300)}},[c,o,g]),Y=s=>{z(s),X(s)},j=s=>{const n=c===s&&o==="asc"?"desc":"asc";R(s),G(n),f.get(y().url,{search:C,sort_by:s,sort_direction:n,per_page:g},{preserveState:!0,replace:!0})},Z=s=>{const n=parseInt(s);J(n),f.get(y().url,{search:C,sort_by:c,sort_direction:o,per_page:n},{preserveState:!0,replace:!0})},ee=s=>{s.preventDefault(),r.post(xe(),{onFinish:()=>{r.reset(),A(!1)}})},se=s=>{s.preventDefault(),t.put(he(t.data.id),{onFinish:()=>{t.reset(),D(!1)}})},te=s=>{N(s),k(!0)},re=()=>{w&&f.delete(pe(w.id).url,{onSuccess:()=>{k(!1),N(null)},onError:()=>{k(!1),N(null)}})},ae=s=>{t.setData({id:s.id,name:s.name,category:s.category,cost_price:s.cost_price.toString(),selling_price:s.selling_price.toString(),current_stock:s.current_stock.toString(),minimum_stock:s.minimum_stock.toString(),description:s.description||""}),D(!0)},ie=s=>{s.preventDefault(),p.post(L.importMethod().url,{onSuccess:()=>{p.reset(),H(!1),f.reload()},onError:()=>{}})},V=s=>`${(typeof s=="string"?parseFloat(s):s).toFixed(2)} VT`,ne=s=>s.current_stock<=0?{status:"Out of Stock",color:"text-red-600 bg-red-50"}:s.current_stock<=s.minimum_stock?{status:"Low Stock",color:"text-orange-600 bg-orange-50"}:{status:"In Stock",color:"text-green-600 bg-green-50"},le=s=>s.current_stock<=0?"text-red-600 font-semibold":s.current_stock<=s.minimum_stock?"text-orange-600 font-semibold":"text-gray-900";return e.jsxs(ue,{breadcrumbs:we,children:[e.jsx(oe,{title:"Inventory"}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(me,{title:"Inventory Management",description:"Manage products, pricing, and stock levels"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{open:K,onOpenChange:A,children:[e.jsx(T,{asChild:!0,children:e.jsx(u,{children:"Add Product"})}),e.jsxs(I,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(E,{children:[e.jsx(q,{children:"Add New Product"}),e.jsx(O,{children:"Create a new product with pricing and stock information."})]}),e.jsxs("form",{onSubmit:ee,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{htmlFor:"name",children:"Product Name *"}),e.jsx(i,{id:"name",type:"text",value:r.data.name,onChange:s=>r.setData("name",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"category",children:"Category *"}),e.jsx(i,{id:"category",type:"text",value:r.data.category,onChange:s=>r.setData("category",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"cost_price",children:"Cost Price (VT) *"}),e.jsx(i,{id:"cost_price",type:"number",step:"0.01",min:"0",value:r.data.cost_price,onChange:s=>r.setData("cost_price",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"selling_price",children:"Selling Price (VT) *"}),e.jsx(i,{id:"selling_price",type:"number",step:"0.01",min:"0",value:r.data.selling_price,onChange:s=>r.setData("selling_price",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"current_stock",children:"Current Stock *"}),e.jsx(i,{id:"current_stock",type:"number",min:"0",value:r.data.current_stock,onChange:s=>r.setData("current_stock",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"minimum_stock",children:"Minimum Stock *"}),e.jsx(i,{id:"minimum_stock",type:"number",min:"0",value:r.data.minimum_stock,onChange:s=>r.setData("minimum_stock",s.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{htmlFor:"description",children:"Description"}),e.jsx("textarea",{id:"description",value:r.data.description,onChange:s=>r.setData("description",s.target.value),className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:3})]})]}),e.jsx($,{children:e.jsx(u,{type:"submit",disabled:r.processing,children:"Create Product"})})]})]})]}),e.jsxs(F,{open:W,onOpenChange:H,children:[e.jsx(T,{asChild:!0,children:e.jsx(u,{variant:"outline",children:"Import Excel"})}),e.jsxs(I,{className:"sm:max-w-[425px]",children:[e.jsxs(E,{children:[e.jsx(q,{children:"Import Products from Excel"}),e.jsx(O,{children:"Upload an Excel file (.xlsx or .xls) to import or update products."}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[e.jsx("a",{href:L.exportSample().url,target:"_blank",className:"text-blue-600 hover:text-blue-800 underline",children:"Download sample Excel format"}),"before uploading."]})]}),e.jsxs("form",{onSubmit:ie,className:"grid gap-4 py-4",encType:"multipart/form-data",children:[e.jsxs("div",{className:"grid items-center gap-4",children:[e.jsx(a,{htmlFor:"excel_file",className:"text-left",children:"Excel File"}),e.jsx(i,{id:"excel_file",type:"file",accept:".xlsx, .xls",onChange:s=>p.setData("file",s.target.files?s.target.files[0]:null),required:!0}),p.errors.file&&e.jsx("div",{className:"text-red-500 text-sm",children:p.errors.file})]}),e.jsx($,{children:e.jsx(u,{type:"submit",disabled:p.processing,children:"Import"})})]})]})]})]})]}),e.jsx(M,{children:e.jsx(B,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(De,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(i,{placeholder:"Search products...",value:C,onChange:s=>Y(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{htmlFor:"per-page",children:"Show:"}),e.jsxs(ve,{value:g.toString(),onValueChange:Z,children:[e.jsx(be,{className:"w-20",children:e.jsx(ye,{})}),e.jsxs(_e,{children:[e.jsx(S,{value:"10",children:"10"}),e.jsx(S,{value:"20",children:"20"}),e.jsx(S,{value:"50",children:"50"}),e.jsx(S,{value:"100",children:"100"})]})]})]})]})})}),e.jsxs(M,{children:[e.jsxs(ge,{children:[e.jsxs(je,{children:["Products (",m.total,")"]}),e.jsxs(fe,{children:[m.from,"-",m.to," of ",m.total," products"]})]}),e.jsxs(B,{children:[e.jsxs(Ce,{children:[e.jsx(ke,{children:e.jsxs(U,{children:[e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>j("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Product Name",c==="name"&&(o==="asc"?e.jsx(v,{className:"h-4 w-4"}):e.jsx(b,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>j("category"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Category",c==="category"&&(o==="asc"?e.jsx(v,{className:"h-4 w-4"}):e.jsx(b,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>j("cost_price"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Cost Price",c==="cost_price"&&(o==="asc"?e.jsx(v,{className:"h-4 w-4"}):e.jsx(b,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>j("selling_price"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Selling Price",c==="selling_price"&&(o==="asc"?e.jsx(v,{className:"h-4 w-4"}):e.jsx(b,{className:"h-4 w-4"}))]})}),e.jsx(x,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>j("current_stock"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Stock",c==="current_stock"&&(o==="asc"?e.jsx(v,{className:"h-4 w-4"}):e.jsx(b,{className:"h-4 w-4"}))]})}),e.jsx(x,{children:"Status"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(Ne,{children:m.data.map(s=>{const n=ne(s);return e.jsxs(U,{children:[e.jsx(h,{className:"font-medium",children:s.name}),e.jsx(h,{children:s.category}),e.jsx(h,{children:V(s.cost_price)}),e.jsx(h,{children:V(s.selling_price)}),e.jsxs(h,{className:le(s),children:[s.current_stock," / ",s.minimum_stock]}),e.jsx(h,{children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n.color}`,children:n.status})}),e.jsx(h,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{children:[e.jsx(T,{asChild:!0,children:e.jsx(u,{size:"sm",variant:"outline",onClick:()=>ae(s),children:"Edit"})}),e.jsxs(I,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(E,{children:[e.jsx(q,{children:"Edit Product"}),e.jsx(O,{children:"Update product information, pricing, and stock levels."})]}),e.jsxs("form",{onSubmit:se,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{htmlFor:"edit-name",children:"Product Name *"}),e.jsx(i,{id:"edit-name",type:"text",value:t.data.name,onChange:l=>t.setData("name",l.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-category",children:"Category *"}),e.jsx(i,{id:"edit-category",type:"text",value:t.data.category,onChange:l=>t.setData("category",l.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-cost_price",children:"Cost Price (VT) *"}),e.jsx(i,{id:"edit-cost_price",type:"number",step:"0.01",min:"0",value:t.data.cost_price,onChange:l=>t.setData("cost_price",l.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-selling_price",children:"Selling Price (VT) *"}),e.jsx(i,{id:"edit-selling_price",type:"number",step:"0.01",min:"0",value:t.data.selling_price,onChange:l=>t.setData("selling_price",l.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-current_stock",children:"Current Stock *"}),e.jsx(i,{id:"edit-current_stock",type:"number",min:"0",value:t.data.current_stock,onChange:l=>t.setData("current_stock",l.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(a,{htmlFor:"edit-minimum_stock",children:"Minimum Stock *"}),e.jsx(i,{id:"edit-minimum_stock",type:"number",min:"0",value:t.data.minimum_stock,onChange:l=>t.setData("minimum_stock",l.target.value),required:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(a,{htmlFor:"edit-description",children:"Description"}),e.jsx("textarea",{id:"edit-description",value:t.data.description,onChange:l=>t.setData("description",l.target.value),className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:3})]})]}),e.jsxs($,{children:[e.jsx(u,{type:"button",variant:"outline",onClick:()=>{t.reset(),D(!1)},children:"Cancel"}),e.jsx(u,{type:"submit",disabled:t.processing,children:"Update Product"})]})]})]})]}),e.jsx(u,{size:"sm",variant:"destructive",onClick:()=>te(s),children:"Delete"})]})})]},s.id)})})]}),m.last_page>1&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("div",{className:"flex gap-2",children:Array.from({length:m.last_page},(s,n)=>n+1).map(s=>e.jsx(de,{href:`${y().url}?page=${s}&search=${C}&sort_by=${c}&sort_direction=${o}&per_page=${g}`,className:`px-3 py-2 rounded ${s===m.current_page?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:s},s))})})]})]})]}),e.jsx(Se,{isOpen:Q,onClose:()=>{k(!1),N(null)},onConfirm:re,itemName:w?.name||""})]})}export{Qe as default};
