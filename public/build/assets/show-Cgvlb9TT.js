import{c as Ce,a as ge,j as t,L as be,r as re,H as Se}from"./app-38lvqsZi.js";import{e as De,B as c}from"./app-logo-icon-D3-YZjDB.js";import{C as H,a as I,b as V,c as E,d as we}from"./card-Ddlm6lvt.js";import{B as Pe}from"./badge-DcjLQEtM.js";import{e as Te,c as Ae,T as ye,b as m,d as ke,a as h}from"./table-b6cFrxfN.js";import{D as Be,f as Le,a as Re,b as Fe,c as He,e as Ie}from"./dialog-DAn2UFrC.js";import{d as Ve,a as Ee,b as Oe,c as ze,S as pe}from"./select-DM--AAJW.js";import{I as je}from"./input-BAVwmEoI.js";import{L as r}from"./label-C6uE05tf.js";import{i as _e,f as Me,D as Ue,U as $e,g as qe,h as Ge,A as Je}from"./app-layout-aoZEk1tT.js";import{A as Ke}from"./arrow-left-DXglfseO.js";import{C as Qe}from"./calculator-BFfEwr_s.js";import{C as We}from"./circle-check-big--PqiIOig.js";/* empty css            */import"./index-Cfsd8eXM.js";import"./index-Cq18JqvT.js";import"./check-Bp6U0sMP.js";import"./index-C-byGbbM.js";function _t(i){const e=Ce.c(89),{dividendPeriod:s,calculations:O}=i;let z;e[0]===Symbol.for("react.memo_cache_sentinel")?(z={title:"Dashboard",href:De()},e[0]=z):z=e[0];let M;e[1]===Symbol.for("react.memo_cache_sentinel")?(M={title:"Dividends",href:_e()},e[1]=M):M=e[1];let U;e[2]!==s.name?(U=[z,M,{title:s.name,href:""}],e[2]=s.name,e[3]=U):U=e[3];const de=U,[$,ce]=ge.useState(null);let q;e[4]===Symbol.for("react.memo_cache_sentinel")?(q={payment_method:"cash",amount:"",payment_date:new Date().toISOString().split("T")[0],reference:"",notes:""},e[4]=q):q=e[4];const[n,o]=ge.useState(q),ve=at,x=st;let G;e[5]!==s.id?(G=()=>{confirm("Calculate dividends for all members based on their purchases during this period?")&&re.post(qe(s.id),{},{onSuccess:tt})},e[5]=s.id,e[6]=G):G=e[6];const oe=G;let J;e[7]!==s.id?(J=()=>{confirm("Approve this dividend period for payout?")&&re.post(Ge(s.id),{},{onSuccess:et})},e[7]=s.id,e[8]=J):J=e[8];const me=J,Ne=Ye;let K;e[9]!==n||e[10]!==$?(K=a=>{a.preventDefault(),$&&re.post(route("dividend-calculations.pay",$.id),n,{onSuccess:()=>{ce(null),o({payment_method:"cash",amount:"",payment_date:new Date().toISOString().split("T")[0],reference:"",notes:""}),window.location.reload()}})},e[9]=n,e[10]=$,e[11]=K):K=e[11];const he=K,Q=Xe,xe=`Dividend Period: ${s.name}`;let f;e[12]!==xe?(f=t.jsx(Se,{title:xe}),e[12]=xe,e[13]=f):f=e[13];let W;e[14]===Symbol.for("react.memo_cache_sentinel")?(W=t.jsx("div",{className:"flex items-center gap-4",children:t.jsx(c,{variant:"ghost",size:"sm",asChild:!0,children:t.jsxs(be,{href:_e(),children:[t.jsx(Ke,{className:"h-4 w-4 mr-2"}),"Back to Dividend Periods"]})})}),e[14]=W):W=e[14];let u;e[15]!==s.id||e[16]!==s.status?(u=s.status==="draft"&&t.jsx(c,{variant:"outline",asChild:!0,children:t.jsx(be,{href:Me(s.id),children:"Edit Period"})}),e[15]=s.id,e[16]=s.status,e[17]=u):u=e[17];let p;e[18]!==s.status||e[19]!==oe?(p=s.status==="draft"&&t.jsxs(c,{onClick:oe,children:[t.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Calculate Dividends"]}),e[18]=s.status,e[19]=oe,e[20]=p):p=e[20];let j;e[21]!==s.status||e[22]!==me?(j=s.status==="calculated"&&t.jsxs(c,{onClick:me,children:[t.jsx(We,{className:"h-4 w-4 mr-2"}),"Approve for Payout"]}),e[21]=s.status,e[22]=me,e[23]=j):j=e[23];let v;e[24]!==u||e[25]!==p||e[26]!==j?(v=t.jsxs("div",{className:"flex items-center justify-between",children:[W,t.jsxs("div",{className:"flex gap-2",children:[u,p,j]})]}),e[24]=u,e[25]=p,e[26]=j,e[27]=v):v=e[27];let X;e[28]===Symbol.for("react.memo_cache_sentinel")?(X=t.jsx(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:t.jsx(E,{className:"text-sm font-medium",children:"Period Status"})}),e[28]=X):X=e[28];let g;e[29]!==s.status?(g=t.jsxs(H,{children:[X,t.jsx(I,{children:t.jsx("div",{className:"text-2xl font-bold",children:ve(s.status)})})]}),e[29]=s.status,e[30]=g):g=e[30];let Y;e[31]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsx(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:t.jsx(E,{className:"text-sm font-medium",children:"Total Profit"})}),e[31]=Y):Y=e[31];const fe=x(s.total_profit);let b;e[32]!==fe?(b=t.jsxs(H,{children:[Y,t.jsx(I,{children:t.jsx("div",{className:"text-2xl font-bold",children:fe})})]}),e[32]=fe,e[33]=b):b=e[33];let Z;e[34]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsx(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:t.jsx(E,{className:"text-sm font-medium",children:"Dividend Rate"})}),e[34]=Z):Z=e[34];let y;e[35]!==s.dividend_rate?(y=t.jsxs(H,{children:[Z,t.jsx(I,{children:t.jsxs("div",{className:"text-2xl font-bold",children:[s.dividend_rate,"%"]})})]}),e[35]=s.dividend_rate,e[36]=y):y=e[36];let ee;e[37]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsx(V,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:t.jsx(E,{className:"text-sm font-medium",children:"Total Dividends"})}),e[37]=ee):ee=e[37];const ue=x(s.total_dividends);let _;e[38]!==ue?(_=t.jsxs(H,{children:[ee,t.jsx(I,{children:t.jsx("div",{className:"text-2xl font-bold",children:ue})})]}),e[38]=ue,e[39]=_):_=e[39];let N;e[40]!==g||e[41]!==b||e[42]!==y||e[43]!==_?(N=t.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[g,b,y,_]}),e[40]=g,e[41]=b,e[42]=y,e[43]=_,e[44]=N):N=e[44];let te;e[45]===Symbol.for("react.memo_cache_sentinel")?(te=t.jsx(V,{children:t.jsx(E,{children:"Period Details"})}),e[45]=te):te=e[45];let se;e[46]===Symbol.for("react.memo_cache_sentinel")?(se=t.jsx(r,{className:"text-sm font-medium",children:"Period Name"}),e[46]=se):se=e[46];let C;e[47]!==s.name?(C=t.jsxs("div",{children:[se,t.jsx("p",{className:"text-sm text-muted-foreground",children:s.name})]}),e[47]=s.name,e[48]=C):C=e[48];let ae;e[49]===Symbol.for("react.memo_cache_sentinel")?(ae=t.jsx(r,{className:"text-sm font-medium",children:"Date Range"}),e[49]=ae):ae=e[49];let S;e[50]!==s.start_date?(S=new Date(s.start_date).toLocaleDateString(),e[50]=s.start_date,e[51]=S):S=e[51];let D;e[52]!==s.end_date?(D=new Date(s.end_date).toLocaleDateString(),e[52]=s.end_date,e[53]=D):D=e[53];let w;e[54]!==S||e[55]!==D?(w=t.jsxs("div",{children:[ae,t.jsxs("p",{className:"text-sm text-muted-foreground",children:[S," - ",D]})]}),e[54]=S,e[55]=D,e[56]=w):w=e[56];let ie;e[57]===Symbol.for("react.memo_cache_sentinel")?(ie=t.jsx(r,{className:"text-sm font-medium",children:"Created By"}),e[57]=ie):ie=e[57];let P;e[58]!==s.created_by.name?(P=t.jsxs("div",{children:[ie,t.jsx("p",{className:"text-sm text-muted-foreground",children:s.created_by.name})]}),e[58]=s.created_by.name,e[59]=P):P=e[59];let le;e[60]===Symbol.for("react.memo_cache_sentinel")?(le=t.jsx(r,{className:"text-sm font-medium",children:"Created Date"}),e[60]=le):le=e[60];let T;e[61]!==s.created_at?(T=new Date(s.created_at).toLocaleDateString(),e[61]=s.created_at,e[62]=T):T=e[62];let A;e[63]!==T?(A=t.jsxs("div",{children:[le,t.jsx("p",{className:"text-sm text-muted-foreground",children:T})]}),e[63]=T,e[64]=A):A=e[64];let k;e[65]!==C||e[66]!==w||e[67]!==P||e[68]!==A?(k=t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[C,w,P,A]}),e[65]=C,e[66]=w,e[67]=P,e[68]=A,e[69]=k):k=e[69];let B;e[70]!==s.notes?(B=s.notes&&t.jsxs("div",{children:[t.jsx(r,{className:"text-sm font-medium",children:"Notes"}),t.jsx("p",{className:"text-sm text-muted-foreground",children:s.notes})]}),e[70]=s.notes,e[71]=B):B=e[71];let L;e[72]!==k||e[73]!==B?(L=t.jsxs(H,{children:[te,t.jsxs(I,{className:"space-y-4",children:[k,B]})]}),e[72]=k,e[73]=B,e[74]=L):L=e[74];let R;e[75]!==O||e[76]!==s.status||e[77]!==he||e[78]!==n?(R=s.status!=="draft"&&t.jsxs(H,{children:[t.jsxs(V,{children:[t.jsx(E,{children:"Dividend Calculations"}),t.jsx(we,{children:"Member dividend calculations based on their purchases during this period."})]}),t.jsxs(I,{children:[t.jsxs(Te,{children:[t.jsx(Ae,{children:t.jsxs(ye,{children:[t.jsx(m,{children:"Member"}),t.jsx(m,{children:"Total Purchases"}),t.jsx(m,{children:"Calculated Dividend"}),t.jsx(m,{children:"Paid Amount"}),t.jsx(m,{children:"Remaining"}),t.jsx(m,{children:"Status"}),t.jsx(m,{children:"Actions"})]})}),t.jsx(ke,{children:O.data.map(a=>t.jsxs(ye,{children:[t.jsx(h,{children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:a.member.name}),t.jsx("div",{className:"text-sm text-muted-foreground",children:a.member.member_code})]})}),t.jsx(h,{children:x(a.total_purchases)}),t.jsx(h,{children:x(a.calculated_dividend)}),t.jsx(h,{children:x(a.paid_amount)}),t.jsx(h,{children:x(Q(a))}),t.jsx(h,{children:ve(a.status)}),t.jsx(h,{children:t.jsxs("div",{className:"flex gap-2",children:[a.status==="pending"&&s.status==="calculated"&&t.jsx(c,{size:"sm",variant:"outline",onClick:()=>Ne(a.id),children:"Approve"}),a.status==="approved"&&Q(a)>0&&t.jsxs(Be,{children:[t.jsx(Le,{asChild:!0,children:t.jsxs(c,{size:"sm",onClick:()=>{ce(a),o(l=>({...l,amount:Q(a).toString()}))},children:[t.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Pay"]})}),t.jsxs(Re,{children:[t.jsxs(Fe,{children:[t.jsx(He,{children:"Process Dividend Payment"}),t.jsxs(Ie,{children:["Pay dividend to ",a.member.name]})]}),t.jsxs("form",{onSubmit:he,className:"space-y-4",children:[t.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(r,{htmlFor:"payment_method",children:"Payment Method"}),t.jsxs(Ve,{value:n.payment_method,onValueChange:l=>o(d=>({...d,payment_method:l})),children:[t.jsx(Ee,{children:t.jsx(Oe,{})}),t.jsxs(ze,{children:[t.jsx(pe,{value:"cash",children:"Cash"}),t.jsx(pe,{value:"credit",children:"Credit to Account"}),t.jsx(pe,{value:"bank_transfer",children:"Bank Transfer"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(r,{htmlFor:"amount",children:"Amount (VT)"}),t.jsx(je,{id:"amount",type:"number",step:"0.01",value:n.amount,onChange:l=>o(d=>({...d,amount:l.target.value})),max:Q(a),required:!0})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(r,{htmlFor:"payment_date",children:"Payment Date"}),t.jsx(je,{id:"payment_date",type:"date",value:n.payment_date,onChange:l=>o(d=>({...d,payment_date:l.target.value})),required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(r,{htmlFor:"reference",children:"Reference (Optional)"}),t.jsx(je,{id:"reference",value:n.reference,onChange:l=>o(d=>({...d,reference:l.target.value})),placeholder:"Transaction ID, receipt number, etc."})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(r,{htmlFor:"notes",children:"Notes (Optional)"}),t.jsx("textarea",{name:"notes",value:n.notes,onChange:l=>o(d=>({...d,notes:l.target.value})),className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:3})]}),t.jsxs("div",{className:"flex justify-end gap-4",children:[t.jsx(c,{type:"button",variant:"outline",onClick:()=>ce(null),children:"Cancel"}),t.jsx(c,{type:"submit",children:"Process Payment"})]})]})]})]})]})})]},a.id))})]}),O.data.length===0&&t.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[t.jsx($e,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),t.jsx("h3",{className:"text-lg font-medium",children:"No dividend calculations yet"}),t.jsx("p",{children:"Calculate dividends to see member entitlement amounts."})]})]})]}),e[75]=O,e[76]=s.status,e[77]=he,e[78]=n,e[79]=R):R=e[79];let F;e[80]!==v||e[81]!==N||e[82]!==L||e[83]!==R?(F=t.jsxs("div",{className:"space-y-6",children:[v,N,L,R]}),e[80]=v,e[81]=N,e[82]=L,e[83]=R,e[84]=F):F=e[84];let ne;return e[85]!==de||e[86]!==F||e[87]!==f?(ne=t.jsxs(Je,{breadcrumbs:de,children:[f,F]}),e[85]=de,e[86]=F,e[87]=f,e[88]=ne):ne=e[88],ne}function Xe(i){return i.calculated_dividend-i.paid_amount}function Ye(i){re.post(route("dividend-calculations.approve",i),{},{onSuccess:Ze})}function Ze(){window.location.reload()}function et(){window.location.reload()}function tt(){window.location.reload()}function st(i){return`VT ${i.toLocaleString("en-VU",{minimumFractionDigits:2})}`}function at(i){const e={pending:"secondary",approved:"warning",paid:"success",cancelled:"destructive"},s={pending:"Pending",approved:"Approved",paid:"Paid",cancelled:"Cancelled"};return t.jsx(Pe,{variant:e[i]||"secondary",children:s[i]||i})}export{_t as default};
