import{u as ne,r as c,a as A,b as D,j as e,H as le,L as ie}from"./app-BjhN-tvY.js";import{H as de}from"./heading-D3ZezZ6y.js";import{c as b,A as oe,e as ce,f as he,g as me}from"./app-layout-Du68zx09.js";import{B as v}from"./app-logo-icon-BPZD09yO.js";import{C as P,d as k,a as xe,b as ue,c as pe}from"./card-MHcbHjeX.js";import{e as I,f as V,d as E,b as $,D as B,a as H,c as O}from"./dialog-C112iB9A.js";import{I as l}from"./input-D5PRjSUJ.js";import{L as n}from"./label-DZCSJwZ8.js";import{S as w,a as _,b as T,c as F,d as o,C as p,e as j}from"./select-pVnsOI3H.js";import{e as je,c as ge,a as q,d as m,f as ve,b as x}from"./table-B0OYXMeZ.js";import{D as be}from"./delete-confirmation-popover-ZkBInUJC.js";import{S as fe}from"./search-CbG5MPTy.js";/* empty css            */import"./index-SvVCGikQ.js";import"./index-DNSXI0Kn.js";import"./index-DMmff4St.js";import"./check--qi0KQcJ.js";const ye=[{title:"Members",href:b().url}];function Le({members:h,filters:f}){const{flash:Ce}=ne().props,[y,L]=c.useState(f.search||""),[i,U]=c.useState(f.sort_by||"created_at"),[d,z]=c.useState(f.sort_direction||"desc"),[g,J]=c.useState(f.per_page||10),[Ne,R]=c.useState(!1),[De,M]=c.useState(!1),[G,C]=c.useState(!1),[S,N]=c.useState(null),r=A({name:"",email:"",phone:"",member_code:"",join_date:"",status:"Active",notes:"",total_spent:"",balance:""}),t=A({id:"",name:"",email:"",phone:"",member_code:"",join_date:"",status:"Active",notes:"",total_spent:"",balance:""}),K=c.useMemo(()=>{let a;return s=>{clearTimeout(a),a=setTimeout(()=>{D.get(b().url,{search:s,sort_by:i,sort_direction:d,per_page:g},{preserveState:!0,replace:!0})},300)}},[i,d,g]),Q=a=>{L(a),K(a)},u=a=>{const s=i===a&&d==="asc"?"desc":"asc";U(a),z(s),D.get(b().url,{search:y,sort_by:a,sort_direction:s,per_page:g},{preserveState:!0,replace:!0})},W=a=>{const s=parseInt(a);J(s),D.get(b().url,{search:y,sort_by:i,sort_direction:d,per_page:s},{preserveState:!0,replace:!0})},X=a=>{a.preventDefault(),r.post(ce(),{onFinish:()=>{r.reset(),R(!1)}})},Y=a=>{a.preventDefault(),t.put(he(t.data.id),{onFinish:()=>{t.reset(),M(!1)}})},Z=a=>{N(a),C(!0)},ee=()=>{S&&D.delete(me(S.id).url,{onSuccess:()=>{C(!1),N(null)},onError:()=>{C(!1),N(null)}})},ae=a=>{t.setData({id:a.id,name:a.name,email:a.email,phone:a.phone||"",member_code:a.member_code||"",join_date:a.join_date,status:a.status,notes:a.notes||"",total_spent:a.total_spent.toString(),balance:a.balance.toString()}),M(!0)},se=a=>{switch(a){case"Active":return"bg-green-100 text-green-800 border-green-200";case"Inactive":return"bg-gray-100 text-gray-800 border-gray-200";case"Suspended":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},te=a=>a>=2e3?"bg-red-100 text-red-800 font-semibold px-2 py-1 rounded-md border border-red-200":"text-gray-900",re=a=>`${(typeof a=="string"?parseFloat(a):a).toFixed(2)} VT`;return e.jsxs(oe,{breadcrumbs:ye,children:[e.jsx(le,{title:"Members"}),e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(de,{title:"Members",description:"Manage member information, balances, and status"}),e.jsxs(I,{children:[e.jsx(V,{asChild:!0,children:e.jsx(v,{children:"Add Member"})}),e.jsxs(E,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs($,{children:[e.jsx(B,{children:"Add New Member"}),e.jsx(H,{children:"Create a new member record with their details."})]}),e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"name",children:"Name *"}),e.jsx(l,{id:"name",type:"text",value:r.data.name,onChange:a=>r.setData("name",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"email",children:"Email *"}),e.jsx(l,{id:"email",type:"email",value:r.data.email,onChange:a=>r.setData("email",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"phone",children:"Phone"}),e.jsx(l,{id:"phone",type:"tel",value:r.data.phone,onChange:a=>r.setData("phone",a.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"member_code",children:"Member Code"}),e.jsx(l,{id:"member_code",type:"text",value:r.data.member_code,onChange:a=>r.setData("member_code",a.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"join_date",children:"Join Date *"}),e.jsx(l,{id:"join_date",type:"date",value:r.data.join_date,onChange:a=>r.setData("join_date",a.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"status",children:"Status *"}),e.jsxs(w,{value:r.data.status,onValueChange:a=>r.setData("status",a),children:[e.jsx(_,{children:e.jsx(T,{placeholder:"Select status"})}),e.jsxs(F,{children:[e.jsx(o,{value:"Active",children:"Active"}),e.jsx(o,{value:"Inactive",children:"Inactive"}),e.jsx(o,{value:"Suspended",children:"Suspended"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{htmlFor:"notes",children:"Notes"}),e.jsx("textarea",{id:"notes",name:"notes",value:r.data.notes,onChange:a=>r.setData("notes",a.target.value),className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:3})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"total_spent",children:"Total Spent (VT)"}),e.jsx(l,{id:"total_spent",type:"number",step:"0.01",min:"0",value:r.data.total_spent,onChange:a=>r.setData("total_spent",a.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"balance",children:"Balance (VT)"}),e.jsx(l,{id:"balance",type:"number",step:"0.01",min:"0",value:r.data.balance,onChange:a=>r.setData("balance",a.target.value)})]})]}),e.jsx(O,{children:e.jsx(v,{type:"submit",children:"Create Member"})})]})]})]})]}),e.jsx(P,{children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(l,{placeholder:"Search members...",value:y,onChange:a=>Q(a.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{htmlFor:"per-page",children:"Show:"}),e.jsxs(w,{value:g.toString(),onValueChange:W,children:[e.jsx(_,{className:"w-20",children:e.jsx(T,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"10",children:"10"}),e.jsx(o,{value:"20",children:"20"}),e.jsx(o,{value:"50",children:"50"}),e.jsx(o,{value:"100",children:"100"})]})]})]})]})})}),e.jsxs(P,{children:[e.jsxs(xe,{children:[e.jsxs(ue,{children:["Members (",h.total,")"]}),e.jsxs(pe,{children:[h.from,"-",h.to," of ",h.total," members"]})]}),e.jsxs(k,{children:[e.jsxs(je,{children:[e.jsx(ge,{children:e.jsxs(q,{children:[e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Name",i==="name"&&(d==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("email"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Email",i==="email"&&(d==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("phone"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Phone",i==="phone"&&(d==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("status"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Status",i==="status"&&(d==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("balance"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Total Unpaid (VT)",i==="balance"&&(d==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{className:"cursor-pointer hover:bg-gray-50",onClick:()=>u("total_spent"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Total Spent (VT)",i==="total_spent"&&(d==="asc"?e.jsx(p,{className:"h-4 w-4"}):e.jsx(j,{className:"h-4 w-4"}))]})}),e.jsx(m,{children:"Actions"})]})}),e.jsx(ve,{children:h.data.map(a=>e.jsxs(q,{children:[e.jsx(x,{className:"font-medium",children:a.name}),e.jsx(x,{children:a.email}),e.jsx(x,{children:a.phone||"-"}),e.jsx(x,{children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-lg text-xs font-semibold border ${se(a.status)}`,children:a.status})}),e.jsx(x,{children:e.jsxs("div",{className:te(a.balance),children:[a.unpaid_total," VT"]})}),e.jsxs(x,{children:[re(a.total_spent)," VT"]}),e.jsx(x,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{children:[e.jsx(V,{asChild:!0,children:e.jsx(v,{size:"sm",variant:"outline",onClick:()=>ae(a),children:"Edit"})}),e.jsxs(E,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs($,{children:[e.jsx(B,{children:"Edit Member"}),e.jsx(H,{children:"Update member information and details."})]}),e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-name",children:"Name *"}),e.jsx(l,{id:"edit-name",type:"text",value:t.data.name,onChange:s=>t.setData("name",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-email",children:"Email *"}),e.jsx(l,{id:"edit-email",type:"email",value:t.data.email,onChange:s=>t.setData("email",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-phone",children:"Phone"}),e.jsx(l,{id:"edit-phone",type:"tel",value:t.data.phone,onChange:s=>t.setData("phone",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-member-code",children:"Member Code"}),e.jsx(l,{id:"edit-member-code",type:"text",value:t.data.member_code,onChange:s=>t.setData("member_code",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-join-date",children:"Join Date *"}),e.jsx(l,{id:"edit-join-date",type:"date",value:t.data.join_date,onChange:s=>t.setData("join_date",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-status",children:"Status *"}),e.jsxs(w,{value:t.data.status,onValueChange:s=>t.setData("status",s),children:[e.jsx(_,{children:e.jsx(T,{})}),e.jsxs(F,{children:[e.jsx(o,{value:"Active",children:"Active"}),e.jsx(o,{value:"Inactive",children:"Inactive"}),e.jsx(o,{value:"Suspended",children:"Suspended"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(n,{htmlFor:"edit-notes",children:"Notes"}),e.jsx("textarea",{id:"edit-notes",value:t.data.notes,onChange:s=>t.setData("notes",s.target.value),className:"flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:3})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-total-spent",children:"Total Spent (VT)"}),e.jsx(l,{id:"edit-total-spent",type:"number",step:"0.01",min:"0",value:t.data.total_spent,onChange:s=>t.setData("total_spent",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"edit-balance",children:"Balance (VT)"}),e.jsx(l,{id:"edit-balance",type:"number",step:"0.01",min:"0",value:t.data.balance,onChange:s=>t.setData("balance",s.target.value)})]})]}),e.jsx(O,{children:e.jsx(v,{type:"submit",disabled:t.processing,children:"Update Member"})})]})]})]}),e.jsx(v,{size:"sm",variant:"destructive",onClick:()=>Z(a),children:"Delete"})]})})]},a.id))})]}),h.last_page>1&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx("div",{className:"flex gap-2",children:Array.from({length:h.last_page},(a,s)=>s+1).map(a=>e.jsx(ie,{href:`${b().url}?page=${a}&search=${y}&sort_by=${i}&sort_direction=${d}&per_page=${g}`,className:`px-3 py-2 rounded ${a===h.current_page?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"}`,children:a},a))})})]})]})]}),e.jsx(be,{isOpen:G,onClose:()=>{C(!1),N(null)},onConfirm:ee,itemName:S?.name||""})]})}export{Le as default};
